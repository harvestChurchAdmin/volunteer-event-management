<%
  const brand = locals.brand || {};
  const variant = typeof layoutVariant !== 'undefined' ? layoutVariant : 'public';
  const appName = brand.appName || 'Volunteer Event Manager';
  const pageTitle = title || appName;
  const tagline = brand.appTagline || 'Coordinate volunteer opportunities with an accessible experience.';
  const faviconUrl = brand.faviconUrl;
  const logoUrl = brand.logoUrl;
  const homePath = brand.homePath || '/';
  const fullTitle = pageTitle === appName ? appName : `${pageTitle} Â· ${appName}`;
  const accountDisplay = user ? (user.displayName || user.email || '') : '';
  const accountInitial = accountDisplay ? accountDisplay.trim().charAt(0).toUpperCase() : 'A';
%>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title><%= fullTitle %></title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="<%= tagline %>">
  <link rel="stylesheet" href="/css/style.css">
  <% if (brand && (brand.brandColor || brand.accentColor || brand.brandStrongColor)) { %>
    <style>
      :root {
        <% if (brand.brandColor) { %>
          --brand: <%= brand.brandColor %>;
          <% /* Derive a stronger brand shade if a specific strong color isn't provided */ %>
          <% if (!brand.brandStrongColor) { %>
            --brand-strong: color-mix(in srgb, <%= brand.brandColor %> 82%, black);
          <% } %>
        <% } %>
        <% if (brand.brandStrongColor) { %>
          --brand-strong: <%= brand.brandStrongColor %>;
        <% } %>
        <% if (brand.accentColor) { %>
          --accent: <%= brand.accentColor %>;
        <% } %>
      }
    </style>
  <% } %>
  <% if (faviconUrl) { %>
    <link rel="icon" type="image/png" href="<%= faviconUrl %>">
  <% } %>
</head>
<body class="app-shell is-<%= variant %>">
<header class="topbar">
  <div class="topbar__inner">
    <a class="topbar__brand" href="<%= homePath %>" aria-label="<%= appName %> home">
      <% if (logoUrl) { %>
        <img class="topbar__logo-image" src="<%= logoUrl %>" alt="<%= appName %> logo">
      <% } %>
      <span class="topbar__text">
        <span class="topbar__title"><%= appName %></span>
      </span>
    </a>
    <button class="topbar__toggle" type="button" data-nav-toggle aria-expanded="false" aria-controls="primary-nav">
      <span class="sr-only">Toggle navigation</span>
      <span class="topbar__toggle-icon" aria-hidden="true"></span>
    </button>
    <nav id="primary-nav" class="topbar__nav" data-nav data-nav-state="closed">
      <ul class="topbar__menu">
        <li><a href="/events">Opportunities</a></li>
        <% if (user) { %>
          <li><a href="/admin/dashboard">Admin Dashboard</a></li>
        <% } %>
      </ul>
    </nav>
    <div class="topbar__actions" aria-label="Account actions">
      <% if (user) { %>
        <details class="account-menu">
          <summary class="account-summary">
            <span class="account-initials" aria-hidden="true"><%= accountInitial %></span>
            <span class="sr-only">Open administrator menu</span>
          </summary>
          <div class="account-menu__body">
            <p class="account-menu__name">
              Signed in as<br>
              <strong><%= accountDisplay %></strong>
            </p>
            <a class="account-menu__link" href="/admin/dashboard">Admin Dashboard</a>
            <a class="account-menu__link" href="/logout">Logout</a>
          </div>
        </details>
      <% } else { %>
        <a class="btn btn-primary" href="/auth/google">Admin Login</a>
      <% } %>
    </div>
  </div>
</header>
<main class="app-main">
