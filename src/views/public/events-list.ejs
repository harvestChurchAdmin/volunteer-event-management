<%- include('../partials/header', { title, user: locals.user, layoutVariant: 'public' }) %>

<section class="page-header page-shell">
  <div>
    <h1>Upcoming Sign-ups</h1>
    <p class="page-subtitle">Find a time that works for you and sign up quickly.</p>
  </div>
</section>

<%- include('../partials/messages', { messages: locals.messages || {} }) %>

<section class="page-section page-shell">
  <div class="tile-grid">
    <% events.forEach(event => { %>
      <% const start = new Date(event.date_start); const end = new Date(event.date_end); %>
      <% const sameDay = start.getFullYear() === end.getFullYear() && start.getMonth() === end.getMonth() && start.getDate() === end.getDate(); %>
      <% const timeOnly = (d) => new Date(d).toLocaleTimeString(undefined, { hour:'numeric', minute:'2-digit' }); %>
      <article class="card event-card">
        <div>
          <p class="event-card__eyebrow">
            <% if (sameDay) { %>
              <%= start.toLocaleDateString(undefined, { month:'short', day:'numeric', year:'numeric' }) %>,
              <%= timeOnly(start) %> – <%= timeOnly(end) %>
            <% } else { %>
              <%= start.toLocaleString(undefined, { month:'short', day:'numeric', year:'numeric', hour:'numeric', minute:'2-digit' }) %>
              &nbsp;–&nbsp;
              <%= end.toLocaleString(undefined, { month:'short', day:'numeric', year:'numeric', hour:'numeric', minute:'2-digit' }) %>
            <% } %>
          </p>
          <h2><%= event.name %></h2>
          <% if (event.description) { %>
            <p class="event-card__copy"><%= event.description %></p>
          <% } %>
        </div>
        <div class="card-actions">
          <a href="/events/<%= event.event_id %>" class="btn btn-primary">View sign-ups</a>
        </div>
      </article>
    <% }) %>
  </div>
</section>

<%- include('../partials/footer') %>
